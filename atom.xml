<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Strive ~</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://blog.biglx.cn/"/>
  <updated>2018-12-25T02:25:57.106Z</updated>
  <id>http://blog.biglx.cn/</id>
  
  <author>
    <name>Strive</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Nginx配置SSL实现HTTPS访问</title>
    <link href="http://blog.biglx.cn/2018/12/24/Nginx%E9%85%8D%E7%BD%AESSL%E5%AE%9E%E7%8E%B0HTTPS%E8%AE%BF%E9%97%AE/"/>
    <id>http://blog.biglx.cn/2018/12/24/Nginx配置SSL实现HTTPS访问/</id>
    <published>2018-12-24T07:09:42.000Z</published>
    <updated>2018-12-25T02:25:57.106Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center">Nginx配置SSL实现HTTPS访问 </blockquote><h2 id="1-申请证书"><a href="#1-申请证书" class="headerlink" title="1. 申请证书"></a>1. 申请证书</h2><p>因为最新搞小程序，接口必须要 HTTPS协议，所以来搞一下~</p><p>腾讯云，阿里云，百度云等都可以申请SSL免费用一年。</p><p>大致如下，以腾讯云为例  </p><p>控制台 -&gt; SSL证书管理 -&gt; 申请证书 -&gt; 域名验证 -&gt; 部署</p><p>申请证书啥的就不多说了，本文就直接从部署开始~~</p><h2 id="2-开始部署"><a href="#2-开始部署" class="headerlink" title="2. 开始部署"></a>2. 开始部署</h2><h3 id="2-1-下载申请好的证书，备用"><a href="#2-1-下载申请好的证书，备用" class="headerlink" title="2.1 下载申请好的证书，备用"></a>2.1 下载申请好的证书，备用</h3><h3 id="2-2-连接服务器，打开Nginx的目录（我的是-etc-nginx-）"><a href="#2-2-连接服务器，打开Nginx的目录（我的是-etc-nginx-）" class="headerlink" title="2.2 连接服务器，打开Nginx的目录（我的是/etc/nginx/）"></a>2.2 连接服务器，打开Nginx的目录（我的是<code>/etc/nginx/</code>）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/nginx/</span><br></pre></td></tr></table></figure><h3 id="2-3-在Nginx的目录里创建cert文件夹，用来存放证书和密匙"><a href="#2-3-在Nginx的目录里创建cert文件夹，用来存放证书和密匙" class="headerlink" title="2.3 在Nginx的目录里创建cert文件夹，用来存放证书和密匙"></a>2.3 在Nginx的目录里创建cert文件夹，用来存放证书和密匙</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir cert</span><br></pre></td></tr></table></figure><h3 id="2-4-把证书压缩包里Nginx的证书和密匙上传到创建好的文件夹里（windows推荐使用xftp工具，mac推荐使用FileZilla）"><a href="#2-4-把证书压缩包里Nginx的证书和密匙上传到创建好的文件夹里（windows推荐使用xftp工具，mac推荐使用FileZilla）" class="headerlink" title="2.4 把证书压缩包里Nginx的证书和密匙上传到创建好的文件夹里（windows推荐使用xftp工具，mac推荐使用FileZilla）"></a>2.4 把证书压缩包里Nginx的证书和密匙上传到创建好的文件夹里（windows推荐使用xftp工具，mac推荐使用FileZilla）</h3><h3 id="2-5-打开nginx的配置文件-nginx-conf-，在http服务里添加以下内容"><a href="#2-5-打开nginx的配置文件-nginx-conf-，在http服务里添加以下内容" class="headerlink" title="2.5 打开nginx的配置文件(nginx.conf)，在http服务里添加以下内容"></a>2.5 打开nginx的配置文件(<code>nginx.conf</code>)，在http服务里添加以下内容</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen 443;</span><br><span class="line">        server_name www.XXXX.com; #填写绑定证书的域名</span><br><span class="line">        ssl on;</span><br><span class="line">        ssl_certificate /etc/nginx/cert/1_www.XXXX.cn_bundle.crt;#域名证书的位置名称</span><br><span class="line">        ssl_certificate_key /etc/nginx/cert/2_www.XXXX.cn.key;#域名证书密匙的位置名称</span><br><span class="line">        ssl_session_timeout 5m;</span><br><span class="line">        ssl_protocols TLSv1 TLSv1.1 TLSv1.2; #按照这个协议配置</span><br><span class="line">        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;#按照这个套件配置</span><br><span class="line">        ssl_prefer_server_ciphers on;</span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /usr/share/nginx/html; #站点目录</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">//nginx对php-fpm的解析转发，如要是PHP环境的话需要到 /etx/nginx/conf.d/default.conf 里的转发设置复制过来</span><br><span class="line">   location ~ \.php$ &#123;</span><br><span class="line">    root           html;</span><br><span class="line">    fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">    fastcgi_index  index.php;</span><br><span class="line">    fastcgi_param  SCRIPT_FILENAME  /usr/share/nginx/html/$fastcgi_script_name; #解析站点目录</span><br><span class="line">    include        fastcgi_params;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-6-输入以下命令检测配置文件，重新加载配置文件"><a href="#2-6-输入以下命令检测配置文件，重新加载配置文件" class="headerlink" title="2.6 输入以下命令检测配置文件，重新加载配置文件"></a>2.6 输入以下命令检测配置文件，重新加载配置文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">nginx -t</span><br><span class="line">nginx -s reload</span><br><span class="line"></span><br><span class="line">[root@VM_39_221_centos nginx]# nginx -t</span><br><span class="line">nginx: the configuration file /etc/nginx/nginx.conf syntax is ok</span><br><span class="line">nginx: configuration file /etc/nginx/nginx.conf test is successful</span><br><span class="line">[root@VM_39_221_centos nginx]# nginx -s reload</span><br><span class="line"></span><br><span class="line">访问你的域名 https://www.XXXX.com 进行测试，如果能成功，就说明配置完成。</span><br></pre></td></tr></table></figure><h3 id="2-7-80端口重定向到443端口，强制开启https"><a href="#2-7-80端口重定向到443端口，强制开启https" class="headerlink" title="2.7 80端口重定向到443端口，强制开启https"></a>2.7 80端口重定向到443端口，强制开启https</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/nginx/nginx.conf 输入以下内容和上边的代码是同级</span><br><span class="line">server &#123;</span><br><span class="line">listen       80;</span><br><span class="line">server_name  www.XXXX.cn;</span><br><span class="line">rewrite ^(.*) https://$host$1 permanent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-设置完成"><a href="#3-设置完成" class="headerlink" title="3. 设置完成"></a>3. 设置完成</h2><h3 id="3-1-如果有不懂的地方可以加我的微信或者QQ联系我"><a href="#3-1-如果有不懂的地方可以加我的微信或者QQ联系我" class="headerlink" title="3.1 如果有不懂的地方可以加我的微信或者QQ联系我~"></a>3.1 如果有不懂的地方可以加我的微信或者QQ联系我~</h3>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote class=&quot;blockquote-center&quot;&gt;Nginx配置SSL实现HTTPS访问 &lt;/blockquote&gt;

&lt;h2 id=&quot;1-申请证书&quot;&gt;&lt;a href=&quot;#1-申请证书&quot; class=&quot;headerlink&quot; title=&quot;1. 申请证书
      
    
    </summary>
    
      <category term="服务器" scheme="http://blog.biglx.cn/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
    
      <category term="Nginx" scheme="http://blog.biglx.cn/tags/Nginx/"/>
    
      <category term="SSL" scheme="http://blog.biglx.cn/tags/SSL/"/>
    
      <category term="HTTPS" scheme="http://blog.biglx.cn/tags/HTTPS/"/>
    
  </entry>
  
  <entry>
    <title>ThinkPHP5自定义跳转页面</title>
    <link href="http://blog.biglx.cn/2017/12/26/ThinkPHP5%E8%87%AA%E5%AE%9A%E4%B9%89%E8%B7%B3%E8%BD%AC%E9%A1%B5%E9%9D%A2/"/>
    <id>http://blog.biglx.cn/2017/12/26/ThinkPHP5自定义跳转页面/</id>
    <published>2017-12-26T00:53:49.000Z</published>
    <updated>2018-12-24T05:53:08.067Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center">ThinkPHP样式简约的页面跳转</blockquote><a id="more"></a><div class="note info"><p>摘自TP<a href="http://www.thinkphp.cn/code/3437.html" target="_blank" rel="external">官网</a>，做了一点小的优化，方便以后的TP核心框架升级 </p></div><h2 id="先看效果图"><a href="#先看效果图" class="headerlink" title="先看效果图"></a>先看效果图</h2><p><strong>自带样式</strong></p><p><img src="http://img.biglx.cn/old.png" alt=""></p><p><strong>修改后的样式</strong></p><p><img src="http://img.biglx.cn/20171226090501.png" alt=""></p><h2 id="第一步"><a href="#第一步" class="headerlink" title="第一步"></a>第一步</h2><p>　　增加对移动设备的支持，在common.php 加入以下函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 对移动端的支持</span><br><span class="line"> * @return bool</span><br><span class="line"> */</span><br><span class="line">function isMobile()</span><br><span class="line">&#123;</span><br><span class="line">    if (isset ($_SERVER[&apos;HTTP_X_WAP_PROFILE&apos;])) &#123;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">    if (isset ($_SERVER[&apos;HTTP_VIA&apos;])) &#123;</span><br><span class="line">        return stristr($_SERVER[&apos;HTTP_VIA&apos;], &quot;wap&quot;) ? true : false;</span><br><span class="line">    &#125;</span><br><span class="line">    if (isset ($_SERVER[&apos;HTTP_USER_AGENT&apos;])) &#123;</span><br><span class="line">        $clientkeywords = array(&apos;nokia&apos;,</span><br><span class="line">            &apos;sony&apos;,</span><br><span class="line">            &apos;ericsson&apos;,</span><br><span class="line">            &apos;mot&apos;,</span><br><span class="line">            &apos;samsung&apos;,</span><br><span class="line">            &apos;htc&apos;,</span><br><span class="line">            &apos;sgh&apos;,</span><br><span class="line">            &apos;lg&apos;,</span><br><span class="line">            &apos;sharp&apos;,</span><br><span class="line">            &apos;sie-&apos;,</span><br><span class="line">            &apos;philips&apos;,</span><br><span class="line">            &apos;panasonic&apos;,</span><br><span class="line">            &apos;alcatel&apos;,</span><br><span class="line">            &apos;lenovo&apos;,</span><br><span class="line">            &apos;iphone&apos;,</span><br><span class="line">            &apos;ipod&apos;,</span><br><span class="line">            &apos;blackberry&apos;,</span><br><span class="line">            &apos;meizu&apos;,</span><br><span class="line">            &apos;android&apos;,</span><br><span class="line">            &apos;netfront&apos;,</span><br><span class="line">            &apos;symbian&apos;,</span><br><span class="line">            &apos;ucweb&apos;,</span><br><span class="line">            &apos;windowsce&apos;,</span><br><span class="line">            &apos;palm&apos;,</span><br><span class="line">            &apos;operamini&apos;,</span><br><span class="line">            &apos;operamobi&apos;,</span><br><span class="line">            &apos;openwave&apos;,</span><br><span class="line">            &apos;nexusone&apos;,</span><br><span class="line">            &apos;cldc&apos;,</span><br><span class="line">            &apos;midp&apos;,</span><br><span class="line">            &apos;wap&apos;,</span><br><span class="line">            &apos;mobile&apos;</span><br><span class="line">        );</span><br><span class="line">        if (preg_match(&quot;/(&quot; . implode(&apos;|&apos;, $clientkeywords) . &quot;)/i&quot;, strtolower($_SERVER[&apos;HTTP_USER_AGENT&apos;]))) &#123;</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (isset ($_SERVER[&apos;HTTP_ACCEPT&apos;])) &#123;</span><br><span class="line">        if ((strpos($_SERVER[&apos;HTTP_ACCEPT&apos;], &apos;vnd.wap.wml&apos;) !== false) &amp;&amp; (strpos($_SERVER[&apos;HTTP_ACCEPT&apos;], &apos;text/html&apos;) === false || (strpos($_SERVER[&apos;HTTP_ACCEPT&apos;], &apos;vnd.wap.wml&apos;) &lt; strpos($_SERVER[&apos;HTTP_ACCEPT&apos;], &apos;text/html&apos;)))) &#123;</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a>第二步</h2><p>　　打开config.php，找到以下代码，并修改配置，如果仅对后台起作用，请在后台模块的配置文件直接修改。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//原配置</span><br><span class="line">&apos;dispatch_success_tmpl&apos; =&gt; THINK_PATH . &apos;tpl&apos; . DS . &apos;dispatch_jump.tpl&apos;,</span><br><span class="line">   &apos;dispatch_error_tmpl&apos; =&gt; THINK_PATH . &apos;tpl&apos; . DS . &apos;dispatch_jump.tpl&apos;,</span><br><span class="line">//新配置 修改配置，提示模板的路径，可自己配置想要的目录。</span><br><span class="line">&apos;dispatch_success_tmpl&apos; =&gt; APP_PATH . &apos;admin&apos;. DS . &apos;view&apos; . DS .&apos;include&apos; . DS .&apos;message.tpl&apos; ,</span><br><span class="line">&apos;dispatch_error_tmpl&apos; =&gt; APP_PATH . &apos;admin&apos;. DS . &apos;view&apos; . DS .&apos;include&apos; . DS .&apos;message.tpl&apos;,</span><br></pre></td></tr></table></figure><p>　　在指定目录里的message.tpl中输入以下代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&#123;__NOLAYOUT__&#125;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;</span><br><span class="line">        &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot;</span><br><span class="line">          content=&quot;width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0, user-scalable=yes&quot;/&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;/&gt;</span><br><span class="line">    &lt;title&gt;跳转提示&lt;/title&gt;</span><br><span class="line">    &lt;?php if(isMobile()==true)&#123;?&gt;</span><br><span class="line">    &lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">    body, h1, h2, p,dl,dd,dt&#123;margin: 0;padding: 0;font: 15px/1.5 微软雅黑,tahoma,arial;&#125;</span><br><span class="line">    body&#123;background:#efefef;&#125;</span><br><span class="line">    h1, h2, h3, h4, h5, h6 &#123;font-size: 100%;cursor:default;&#125;</span><br><span class="line">    ul, ol &#123;list-style: none outside none;&#125;</span><br><span class="line">    a &#123;text-decoration: none;color:#447BC4&#125;</span><br><span class="line">    a:hover &#123;text-decoration: underline;&#125;</span><br><span class="line">    .ip-attack&#123;width:100%; margin:200px auto 0;&#125;</span><br><span class="line">    .ip-attack dl&#123; background:#fff; padding:30px; border-radius:10px;border: 1px solid #CDCDCD;-webkit-box-shadow: 0 0 8px #CDCDCD;-moz-box-shadow: 0 0 8px #cdcdcd;box-shadow: 0 0 8px #CDCDCD;&#125;</span><br><span class="line">        .ip-attack dt&#123;text-align:center;&#125;</span><br><span class="line">        .ip-attack dd&#123;font-size:16px; color:#333; text-align:center;&#125;</span><br><span class="line">        .tips&#123;text-align:center; font-size:14px; line-height:50px; color:#999;&#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">    &lt;?php &#125;else&#123; ?&gt;</span><br><span class="line">    &lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">        body, h1, h2, p, dl, dd, dt&#123;margin: 0;padding: 0;font: 15px/1.5 微软雅黑,tahoma,arial;&#125; body&#123;background:#efefef;&#125; h1, h2, h3, h4, h5, h6 &#123;font-size: 100%;cursor:default;&#125; ul, ol &#123;list-style: none outside none;&#125; a &#123;text-decoration: none;color:#447BC4&#125; a:hover &#123;text-decoration: underline;&#125; .ip-attack&#123;width:600px; margin:200px auto 0;&#125; .ip-attack dl &#123;</span><br><span class="line">            background: #fff;</span><br><span class="line">            padding: 30px;</span><br><span class="line">            border-radius: 10px;</span><br><span class="line">            border: 1px solid #CDCDCD;</span><br><span class="line">            -webkit-box-shadow: 0 0 8px #CDCDCD;</span><br><span class="line">            -moz-box-shadow: 0 0 8px #cdcdcd;</span><br><span class="line">            box-shadow: 0 0 8px #CDCDCD;</span><br><span class="line">        &#125;</span><br><span class="line">        .ip-attack dt&#123;text-align:center;&#125; .ip-attack dd&#123;font-size:16px; color:#333; text-align:center;&#125; .tips</span><br><span class="line"></span><br><span class="line">        &#123;text-align:center; font-size:14px; line-height:50px; color:#999;&#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">    &lt;?php &#125;?&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class=&quot;ip-attack&quot;&gt;</span><br><span class="line">    &lt;dl&gt;</span><br><span class="line">        &lt;?php switch ($code) &#123;?&gt;</span><br><span class="line">        &lt;?php case 1:?&gt;</span><br><span class="line">        &lt;dt style=&quot;color: green&quot;&gt;&lt;?php echo(strip_tags($msg));?&gt;&lt;/dt&gt;</span><br><span class="line">        &lt;?php break;?&gt;</span><br><span class="line">        &lt;?php case 0:?&gt;</span><br><span class="line">        &lt;dt style=&quot;color: red&quot;&gt;&lt;?php echo(strip_tags($msg));?&gt;&lt;/dt&gt;</span><br><span class="line">        &lt;?php break;?&gt;</span><br><span class="line">        &lt;?php &#125; ?&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;dt&gt;</span><br><span class="line">            页面自动 &lt;a id=&quot;href&quot; href=&quot;&lt;?php echo($url);?&gt;&quot;&gt;跳转&lt;/a&gt; 等待时间： &lt;b id=&quot;wait&quot;&gt;&lt;?php echo($wait);?&gt;&lt;/b&gt;</span><br><span class="line">        &lt;/dt&gt;</span><br><span class="line">    &lt;/dl&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    (function () &#123;</span><br><span class="line">        var wait = document.getElementById(&apos;wait&apos;),</span><br><span class="line">            href = document.getElementById(&apos;href&apos;).href;</span><br><span class="line">        var interval = setInterval(function () &#123;</span><br><span class="line">            var time = --wait.innerHTML;</span><br><span class="line">            if (time &lt;= 0) &#123;</span><br><span class="line">                location.href = href;</span><br><span class="line">                clearInterval(interval);</span><br><span class="line">            &#125;</span><br><span class="line">            ;</span><br><span class="line">        &#125;, 1000);</span><br><span class="line">    &#125;)();</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h2 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h2><p>　　到此自定义跳转模板修改完成，除此以外大家有自己喜欢的模板也可以换上，操作是一样的~</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;ThinkPHP样式简约的页面跳转&lt;/blockquote&gt;
    
    </summary>
    
      <category term="PHP" scheme="http://blog.biglx.cn/categories/PHP/"/>
    
    
      <category term="ThinkPHP" scheme="http://blog.biglx.cn/tags/ThinkPHP/"/>
    
  </entry>
  
  <entry>
    <title>搭建lnmp(php7.1+nginx+mysql5.7)</title>
    <link href="http://blog.biglx.cn/2017/11/30/%E6%90%AD%E5%BB%BAlnmp-php7-1-nginx-mysql5-7/"/>
    <id>http://blog.biglx.cn/2017/11/30/搭建lnmp-php7-1-nginx-mysql5-7/</id>
    <published>2017-11-30T08:17:32.000Z</published>
    <updated>2018-12-24T05:53:14.811Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center">基于 centOS7.2 搭建LNMP服务器 </blockquote><a id="more"></a><h2 id="检查更新yum"><a href="#检查更新yum" class="headerlink" title="检查更新yum"></a>检查更新yum</h2><p>首先用ssh登陆服务器,查看一下linux的版本信息,并执行<code>yum update</code>更新系统,当然如果你的服务器是按流量收费的话,可以不更新.</p><center><img src="http://img.biglx.cn/aliyun1.png" alt=""></center><h2 id="安装nginx"><a href="#安装nginx" class="headerlink" title="安装nginx"></a>安装nginx</h2><p>使用yum安装nginx的最新源</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum localinstall http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm</span><br></pre></td></tr></table></figure><center><img src="http://img.biglx.cn/aliyun2.png" alt=""></center><p>检查nginx源是否安装成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum repolist enabled | grep &quot;nginx*&quot;</span><br></pre></td></tr></table></figure><center><img src="http://img.biglx.cn/aliyun3.png" alt=""></center><p>安装nginx</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install nginx</span><br></pre></td></tr></table></figure><center><img src="http://img.biglx.cn/aliyun4.png" alt=""></center><p>启动nginx</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service nginx start</span><br></pre></td></tr></table></figure><p>设置nginx服务器开机自启动</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable nginx.service</span><br></pre></td></tr></table></figure><p>检查开机自动是否设置成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl list-dependencies | grep nginx</span><br></pre></td></tr></table></figure><center><img src="http://img.biglx.cn/aliyun5.png" alt=""></center><p>在浏览器中输入服务器的公网ip，检查nginx服务器运行是否正常，出现以下界面算是安装成功</p><center><img src="http://img.biglx.cn/aliyun6.png" alt=""></center><h2 id="安装Mysql"><a href="#安装Mysql" class="headerlink" title="安装Mysql"></a>安装Mysql</h2><p>接下来安装5.7.x的mysql, 因为mysql5.7之后可以支持json操作。</p><p>安装5.7.x的mysql源</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y localinstall  http://dev.mysql.com/get/mysql57-community-release-el7-7.noarch.rpm</span><br></pre></td></tr></table></figure><center><img src="http://img.biglx.cn/aliyun7.png" alt=""></center><p>检查mysql源是否安装成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum repolist enabled | grep &quot;mysql.*-community.*&quot;</span><br></pre></td></tr></table></figure><center><img src="http://img.biglx.cn/aliyun8.png" alt=""></center><p>源设置成功之后, 继续安装mysql 并启动, 加入开机自启动服务,并在命令行验证</p><p>安装Mysql</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install mysql-community-server install mysql-community-devel</span><br></pre></td></tr></table></figure><center><img src="http://img.biglx.cn/aliyun9.png" alt=""></center><p>启动mysql</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysqld start</span><br></pre></td></tr></table></figure><p>检查mysql启动是否正常</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysqld status 或者 ps -ef | grep mysql</span><br></pre></td></tr></table></figure><p>设置mysqld服务开机自启动</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable mysqld.service</span><br></pre></td></tr></table></figure><p>检查mysqld开机自启动是否设置成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl list-dependencies | grep mysqld</span><br></pre></td></tr></table></figure><center><img src="http://img.biglx.cn/aliyun10.png" alt=""></center><p>查阅mysql的官方文档(文档在上面工具/原料里面有写),查询对应的随机密码, 这里说明一下mysql5.7以后的争强了安全机制, 所以使用yum安装,启动会系统会自动生成一个随机的密码.</p><p>查看mysql的随机密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep &apos;temporary password&apos; /var/log/mysqld.log</span><br></pre></td></tr></table></figure><p>使用查询得到的随机密码在终端登录</p><center><img src="http://img.biglx.cn/aliyun11.png" alt=""></center><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p    更改密码(mysql文档规定,密码必须包括大小写字母数字加特殊符号&gt;8位)</span><br><span class="line">ALTER USER &apos;root&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;你要设置的密码&apos;;</span><br><span class="line">退出mysql客户端,用刚才修改的密码登录确保密码修改成功</span><br><span class="line">mysql -uroot -pxxxxx</span><br></pre></td></tr></table></figure><center><img src="http://img.biglx.cn/aliyun12.png" alt=""></center><h2 id="安装php以及扩展"><a href="#安装php以及扩展" class="headerlink" title="安装php以及扩展"></a>安装php以及扩展</h2><p>安装php71的源</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</span><br><span class="line">rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm</span><br></pre></td></tr></table></figure><p>检查源是否安装成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum repolist enabled | grep &quot;webtatic*&quot;</span><br></pre></td></tr></table></figure><center><img src="http://img.biglx.cn/aliyun13.png" alt=""></center><p>安装php71和对应的扩展</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum -y install php71w php71w-fpm</span><br><span class="line">yum -y install php71w-mbstring php71w-common php71w-gd php71w-mcrypt</span><br><span class="line">yum -y install php71w-mysql php71w-xml php71w-cli php71w-devel</span><br><span class="line">yum -y install php71w-pecl-memcached php71w-pecl-redis php71w-opcache</span><br></pre></td></tr></table></figure><center><img src="http://img.biglx.cn/aliyun14.png" alt=""></center><p>验证php是否安装成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -v</span><br></pre></td></tr></table></figure><center><img src="http://img.biglx.cn/aliyun15.png" alt=""></center><p>验证对应的扩展是否安装成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -m</span><br></pre></td></tr></table></figure><center><img src="http://img.biglx.cn/aliyun16.png" alt=""></center><p>设置php-fpm并检测php-fpm的运行状态</p><p>启动php-fpm</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service php-fpm start</span><br></pre></td></tr></table></figure><p>检查启动是否成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service php-fpm status</span><br></pre></td></tr></table></figure><p>设置开机自启动</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable php-fpm.service</span><br></pre></td></tr></table></figure><center><img src="http://img.biglx.cn/aliyun17.png" alt=""></center><p>检查开机自启动是否设置成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl list-dependencies | grep php-fpm</span><br></pre></td></tr></table></figure><center><img src="http://img.biglx.cn/aliyun18.png" alt=""></center><h2 id="修改default-conf文件Nginx对php进行转发"><a href="#修改default-conf文件Nginx对php进行转发" class="headerlink" title="修改default.conf文件Nginx对php进行转发"></a>修改default.conf文件Nginx对php进行转发</h2><p>切换并打开配置文件，把注释解开并修改，以下代码作为参考。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/nginx/conf.d/default.conf</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    #charset koi8-r;</span><br><span class="line">    #access_log  /var/log/nginx/host.access.log  main;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    #error_page  404              /404.html;</span><br><span class="line"></span><br><span class="line">    # redirect server error pages to the static page /50x.html</span><br><span class="line">    #</span><br><span class="line">    error_page   500 502 503 504  /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">    #</span><br><span class="line">    #location ~ \.php$ &#123;</span><br><span class="line">    #    proxy_pass   http://127.0.0.1;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line">    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">    #</span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">        root           html;</span><br><span class="line">        fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">        fastcgi_index  index.php;</span><br><span class="line">        fastcgi_param  SCRIPT_FILENAME  /usr/share/nginx/html/$fastcgi_script_name;</span><br><span class="line">        include        fastcgi_params;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    # deny access to .htaccess files, if Apache&apos;s document root</span><br><span class="line">    # concurs with nginx&apos;s one</span><br><span class="line">    #</span><br><span class="line">    #location ~ /\.ht &#123;</span><br><span class="line">    #    deny  all;</span><br><span class="line">    #&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Mysql不能远程访问解决办法"><a href="#Mysql不能远程访问解决办法" class="headerlink" title="Mysql不能远程访问解决办法"></a>Mysql不能远程访问解决办法</h2><p>从任何主机上使用root用户，密码：youpassword（你的root密码）连接到mysql服务器：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># mysql -u root -p </span><br><span class="line">mysql&gt;GRANT ALL PRIVILEGES ON *.* TO &apos;root&apos;@&apos;%&apos; IDENTIFIED BY &apos;youpassword&apos; WITH GRANT OPTION;</span><br></pre></td></tr></table></figure><p>操作完后切记执行以下命令刷新权限 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLUSH PRIVILEGES</span><br></pre></td></tr></table></figure><h2 id="测试是否安装成功"><a href="#测试是否安装成功" class="headerlink" title="测试是否安装成功"></a>测试是否安装成功</h2><p>切换目录，此目录相当于apache服务器里的WWW目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/share/nginx/html/</span><br></pre></td></tr></table></figure><p>创建文件并输入以下代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">phpinfo();</span><br></pre></td></tr></table></figure><p>在浏览器输入 <a href="http://IP/index.php" target="_blank" rel="external">http://IP/index.php</a> 出现PHP信息的页面就算安装成功。</p><h2 id="注"><a href="#注" class="headerlink" title="注"></a>注</h2><p>到此Lnmp服务器安装成功，有问题可以联系博主~Thanks！</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;基于 centOS7.2 搭建LNMP服务器 &lt;/blockquote&gt;
    
    </summary>
    
      <category term="服务器" scheme="http://blog.biglx.cn/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
    
      <category term="服务器" scheme="http://blog.biglx.cn/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
      <category term="Nginx" scheme="http://blog.biglx.cn/tags/Nginx/"/>
    
      <category term="Lnmp" scheme="http://blog.biglx.cn/tags/Lnmp/"/>
    
  </entry>
  
  <entry>
    <title>第一篇博客</title>
    <link href="http://blog.biglx.cn/2017/11/16/%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/"/>
    <id>http://blog.biglx.cn/2017/11/16/第一篇博客/</id>
    <published>2017-11-16T01:14:06.000Z</published>
    <updated>2017-11-27T08:12:20.516Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center">HelloWorld</blockquote><a id="more"></a><p>　　本博客成立于2017年11月16日，使用 hexo＋GitHub Pages 完成搭建本博客会不定时更新本人技术和生活上的文章和心情，感谢大家访问我的个人博客。</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;HelloWorld&lt;/blockquote&gt;
    
    </summary>
    
      <category term="HelloWorld" scheme="http://blog.biglx.cn/categories/HelloWorld/"/>
    
    
      <category term="博客" scheme="http://blog.biglx.cn/tags/%E5%8D%9A%E5%AE%A2/"/>
    
  </entry>
  
</feed>
